/*!
 * vue-datepicker v0.1.2
 * https://github.com/weifeiyue/vue-datepicker
 * (c) 2016 weifeiyue
 * Released under the MIT License.
 */
!function(a){"use strict";"function"==typeof define&&define.amd?define(["vue"],a):"object"==typeof exports?a(require("vue")):a(Vue)}(function(a){a.component("mz-datepicker",{template:'<div class="mz-datepicker" :style="{width:width+\'px\'}"><input :value="value" readonly :disabled="disabled" :class="{focus:show}" @click="click" @mousedown="$event.preventDefault()"/><a v-if="clearable&&value" @click.stop="clear"></a><i @click="click"></i><div class="mz-datepicker-popup" :class="{\'mz-datepicker-popup-left\':left}" v-if="show" transition="mz-datepicker-popup" tabindex="-1" @blur="show = false" @mousedown="$event.preventDefault()" @keyup.up="changeMonth(-1,1)" @keyup.down="changeMonth(1,1)" @keyup.left="changeYear(-1,1)" @keyup.right="changeYear(1,1)" v-el:popup><div class="mz-calendar-top" v-if="range&&!en"><template v-for="item in ranges"><i v-if="$index"></i><a v-text="item.name" @click="selectRange(item)"></a></template></div><div :class="{\'mz-calendar-range\':range}"><template v-for="no in count"><div class="mz-calendar"><div class="mz-calendar-header"><a class="mz-calendar-prev-year" :title="prevYearTitle" @click="changeYear(-1,no+1)">«</a><a class="mz-calendar-prev-month" :title="prevMonthTitle" @click="changeMonth(-1,no+1)">‹</a><a v-if="!en" class="mz-calendar-year-select" :title="selectYearTitle" @click="showYear(no+1)">{{this[\'now\'+(no+1)].getFullYear()+(en?"":"年")}}</a><a v-if="!en" class="mz-calendar-month-select" :title="selectMonthTitle" @click="showMonth(no+1)">{{months[this[\'now\'+(no+1)].getMonth()]}}</a><a v-if="en" class="mz-calendar-month-select" :title="selectMonthTitle" @click="showMonth(no+1)">{{months[this[\'now\'+(no+1)].getMonth()]}}</a><a v-if="en" class="mz-calendar-year-select" :title="selectYearTitle" @click="showYear(no+1)">{{this[\'now\'+(no+1)].getFullYear()+(en?"":"年")}}</a><a class="mz-calendar-next-month" :title="nextMonthTitle" @click="changeMonth(1,no+1)">›</a><a class="mz-calendar-next-year" :title="nextYearTitle" @click="changeYear(1,no+1)">»</a></div><table cellspacing="0" cellpadding="0"><tr><th v-for="day in days" v-text="day"></th></tr><tr v-if="this[\'date\'+(no+1)]" v-for="i in 6"><td v-for="j in 7" v-text="this[\'date\'+(no+1)][i * 7 + j].text" :title="this[\'date\'+(no+1)][i * 7 + j].title" :class="this[\'date\'+(no+1)][i * 7 + j].status" @click="select(this[\'date\'+(no+1)][i * 7 + j], no+1)"></td></tr></table><div class="mz-calendar-year-panel" transition="mz-calendar-panel" v-if="this[\'showYear\'+(no+1)]"><a class="mz-calendar-year-panel-prev" @click="changeYearRange(no+1,-1)"></a><a class="mz-calendar-year-panel-year" v-for="item in this[\'years\'+(no+1)]" :class="item.status" @click="selectYear(item,no+1)">{{item.year+(en?"":"年")}}</a><a class="mz-calendar-year-panel-next" @click="changeYearRange(no+1,1)"></a></div><div class="mz-calendar-month-panel" transition="mz-calendar-panel" v-if="this[\'showMonth\'+(no+1)]"><a v-for="item in this[\'months\'+(no+1)]" class="mz-calendar-month-panel-month" :class="item.status" @click="selectMonth(item,no+1)">{{months[item.month-1].substr(0,3)}}</a></div></div><div class="mz-calendar-separator" v-if="range&&no===0"><span>{{toTitle}}</span></div></template></div><div class="mz-calendar-bottom" v-if="range"><a class="mz-calendar-btn ok" @click="ok">{{okTitle}}</a></div></div></div>',props:{range:{type:Boolean,"default":!1},width:{"default":214},time:{twoWay:!0},startTime:{twoWay:!0},endTime:{twoWay:!0},maxRange:{coerce:function(a){return+a}},clearable:{type:Boolean,"default":!1},format:{type:String,"default":"yyyy-MM-dd"},disabled:{type:Boolean,"default":!1},confirm:{type:Boolean,"default":!1},en:{type:Boolean,"default":!1},onConfirm:Function},data:function(){return{show:!1,showYear1:!1,showYear2:!1,showMonth1:!1,showMonth2:!1,prevYearTitle:this.en?"last year":"上一年",prevMonthTitle:this.en?"last month":"上个月",selectYearTitle:this.en?"select year":"选择年份",selectMonthTitle:this.en?"select month":"选择月份",nextMonthTitle:this.en?"next month":"下个月",nextYearTitle:this.en?"next year":"下一年",toTitle:this.en?"TO":"至",okTitle:this.en?"OK":"确定",left:!1,ranges:[],days:this.en?["Mo","Tu","We","Th","Fr","Sa","Su"]:["一","二","三","四","五","六","日"],months:this.en?["January","February","March","April","May","June","July","August","September","October","November","December"]:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],years1:[],years2:[],months1:[],months2:[],date1:null,date2:null,time1:this.parse(this.startTime,!1)||this.parse(this.time,!1),time2:this.parse(this.endTime,!0),now1:this.parse(new Date,!1),now2:this.parse(new Date,!0),count:this.range?2:1}},computed:{value:function(){return this.range?this.startTime&&this.endTime?this.stringify(this.parse(this.startTime,!1))+" ~ "+this.stringify(this.parse(this.endTime,!1)):"":this.stringify(this.parse(this.time,!1))}},watch:{show:function(a){this.hidePanel(),a&&this.$els.popup.focus()},now1:function(){this.updateAll()},now2:function(){this.updateAll()}},methods:{parse:function(a,b){if(a){var c=new Date(a);return void 0===b?c:b?new Date(c.getFullYear(),c.getMonth(),c.getDate(),23,59,59,999):new Date(c.getFullYear(),c.getMonth(),c.getDate())}return null},initRanges:function(){var a=new Date,b=[];b.push({name:"今天",start:this.parse(a,!1),end:this.parse(a,!0)}),a.setDate(a.getDate()-1),b.push({name:"昨天",start:this.parse(a,!1),end:this.parse(a,!0)}),a=new Date,a.setDate(a.getDate()-6),b.push({name:"最近7天",start:this.parse(a,!1),end:this.parse(new Date,!0)}),a=new Date,a.setMonth(a.getMonth()+1,0),b.push({name:"本月",start:new Date(a.getFullYear(),a.getMonth(),1),end:this.parse(a,!0)}),a=new Date,a.setMonth(a.getMonth(),0),b.push({name:"上个月",start:new Date(a.getFullYear(),a.getMonth(),1),end:this.parse(a,!0)}),a=new Date,a.setDate(a.getDate()-29),b.push({name:"最近一个月",start:this.parse(a,!1),end:this.parse(new Date,!0)}),a=new Date,a.setDate(a.getDate()-365),b.push({name:"最近一年",start:this.parse(a,!1),end:this.parse(new Date,!0)}),this.ranges=b},updateAll:function(){this.update(new Date(this.now1),1),this.range&&this.update(new Date(this.now2),2)},click:function(){var b,c,a=this;a.time1=a.parse(a.startTime)||a.parse(a.time),a.now1=a.parse(a.startTime)||new Date,a.range&&(a.initRanges(),a.time2=a.parse(a.endTime),a.now2=a.parse(a.endTime)||new Date),b=this.$el.getBoundingClientRect(),c=document.documentElement.clientWidth-b.left,a.left=c<(a.range?441:214)&&c<b.left?!0:!1,a.show=!a.show},select:function(a,b){var c=this;c.hidePanel(),-1===a.status.indexOf("mz-calendar-disabled")&&(c["now"+b]=new Date(a.time),c["time"+b]=new Date(a.time),c.range?c.confirm||(c[1===b?"startTime":"endTime"]=c.getOutTime(a.time)):(c.time=c.getOutTime(a.time),c.show=!1))},ok:function(){var a=this;a.show=!1,a.range&&a.confirm&&(a.startTime=a.getOutTime(a.time1),a.endTime=a.getOutTime(a.time2),a.onConfirm&&a.onConfirm(a.startTime,a.endTime))},selectRange:function(a){var b=this;b.now1=new Date(a.start),b.now2=new Date(a.end),b.time1=new Date(a.start),b.time2=new Date(a.end),b.startTime=b.getOutTime(a.start),b.endTime=b.getOutTime(a.end),b.hidePanel()},getOutTime:function(a){var b=this.time?typeof this.time:typeof this.startTime;return"number"===b?a.getTime():"object"===b?new Date(a):this.stringify(a)},update:function(a,b){var c,d,e,f,g,h,i=[];for(a.setDate(0),e=a.getDay(),f=a.getDate(),c=e;c>0;c--)h=f-c+1,d=new Date(a.getFullYear(),a.getMonth(),h),d=this.parse(d,2===b),i.push({status:this.getTimeStatus(d,b)||"mz-calendar-lastmonth",title:this.stringify(d),text:h,time:d});for(a.setMonth(a.getMonth()+2,0),g=a.getDate(),a.setDate(1),c=1;g>=c;c++)d=new Date(a.getFullYear(),a.getMonth(),c),d=this.parse(d,2===b),i.push({status:this.getTimeStatus(d,b),title:this.stringify(d),text:c,time:d});for(c=1;i.length<42;c++)d=new Date(a.getFullYear(),a.getMonth()+1,c),d=this.parse(d,2===b),i.push({status:this.getTimeStatus(d,b)||"mz-calendar-nextmonth",title:this.stringify(d),text:c,time:d});this["date"+b]=i},getTimeStatus:function(a,b,c){var j,k,d="",e=new Date,f=this["time"+b],g=this.stringify(a,c||"yyyy-MM-dd"),h=this.stringify(e,c||"yyyy-MM-dd"),i=this.stringify(f,c||"yyyy-MM-dd");return g===i?d="mz-calendar-selected":g===h&&(d="mz-calendar-today"),this.time1&&this.time2&&a>=this.time1&&a<=this.time2&&(d+=" mz-calendar-inrange"),1==b&&this.time2&&(j=new Date(this.time2),this.maxRange?(j.setDate(j.getDate()-this.maxRange),"yyyy"===c&&(j=new Date(j.getFullYear(),0,1)),"yyyy-MM"===c&&(j=new Date(j.getFullYear(),0,1)),(j>a||a>this.time2)&&(d+=" mz-calendar-disabled")):a>this.time2&&(d+=" mz-calendar-disabled"),a>this.time2&&(d+=" mz-calendar-disabled")),2==b&&this.time1&&(k=new Date(this.time1),this.maxRange?(k.setDate(k.getDate()+this.maxRange),"yyyy"===c&&(k=new Date(k.getFullYear(),11,1)),"yyyy-MM"===c&&(k=new Date(k.getFullYear(),k.getMonth()+1,1)),(a>k||a<this.time1)&&(d+=" mz-calendar-disabled")):a<this.time1&&(d+=" mz-calendar-disabled")),d},stringify:function(a,b){var c,d,e,f,g,h,i,j,k;return a?(b=b||this.format,c=a.getFullYear(),d=a.getMonth()+1,e=a.getDate(),f=a.getHours(),g=0===f%12?12:f%12,h=a.getMinutes(),i=a.getSeconds(),j=a.getMilliseconds(),k={yyyy:c,MM:("0"+d).slice(-2),M:d,dd:("0"+e).slice(-2),d:e,HH:("0"+f).slice(-2),H:f,hh:("0"+g).slice(-2),h:g,mm:("0"+h).slice(-2),m:h,ss:("0"+i).slice(-2),s:i,S:j},b.replace(/y+|M+|d+|H+|h+|m+|s+|S+/g,function(a){return k[a]})):""},showYear:function(a){var c,d,e,b="showYear"+a;for(this.hidePanel(b),this[b]=!this[b],c=new Date(this["now"+a]||new Date),d=Math.floor(c.getFullYear()%10),e=[],c.setDate(1),c.setFullYear(c.getFullYear()-d);e.length<10;)2===a&&c.setMonth(c.getMonth()+1,0),e.push({year:c.getFullYear(),status:this.getTimeStatus(c,a,"yyyy")}),c.setDate(1),c.setFullYear(c.getFullYear()+1);this["years"+a]=e},showMonth:function(a){var c,d,b="showMonth"+a;for(this.hidePanel(b),this[b]=!this[b],c=new Date(this["now"+a]||new Date),d=[];d.length<12;)c.setDate(1),c.setMonth(d.length),2===a&&c.setMonth(c.getMonth()+1,0),d.push({month:d.length+1,status:this.getTimeStatus(c,a,"yyyy-MM")});this["months"+a]=d},changeYearRange:function(a,b){var e,f,g,c=this["years"+a],d=new Date(this["time"+a]||new Date);for(e in c)f=c[e],g=f.year+10*b,d.setDate(1),d.setFullYear(g),2===a&&d.setMonth(d.getMonth()+1,0),f.year=g,f.status=this.getTimeStatus(d,a)},changeYear:function(a,b){var c=this["now"+b];c.setDate(1),c.setFullYear(c.getFullYear()+a),2===b&&c.setMonth(c.getMonth()+1,0),this["now"+b]=new Date(c),this.hidePanel()},changeMonth:function(a,b){var c=this["now"+b];c.setDate(1),c.setMonth(c.getMonth()+a),2===b&&c.setMonth(c.getMonth()+1,0),this["now"+b]=new Date(c),this.hidePanel()},selectYear:function(a,b){if(-1===a.status.indexOf("mz-calendar-disabled")){var c=this["now"+b];c.setFullYear(a.year),this["now"+b]=new Date(c),this.hidePanel()}},selectMonth:function(a,b){if(-1===a.status.indexOf("mz-calendar-disabled")){var c=this["now"+b];c.setMonth(a.month-1),this["now"+b]=new Date(c),this.hidePanel()}},hidePanel:function(a){["showYear1","showYear2","showMonth1","showMonth2"].map(function(b){b!==a&&(this[b]=!1)}.bind(this))},clear:function(){var a=this;a.time1=a.time2=a.startTime=a.endTime=a.time=null,a.now1=new Date,a.now2=new Date}}})});